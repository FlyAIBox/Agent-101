{
  "id": "8tusZTTtcyaiznEG",
  "meta": {
    "instanceId": "31e69f7f4a77bf465b805824e303232f0227212ae922d12133a0f96ffeab4fef",
    "templateCredsSetupCompleted": true
  },
  "name": "ğŸ¤– AIé©±åŠ¨çš„RAGèŠå¤©æœºå™¨äºº - æ–‡æ¡£ + Google Drive + Gemini + Qdrant",
  "tags": [],
  "nodes": [
    {
      "id": "7ad5796b-d1a0-4cc1-bed6-105ff499beeb",
      "name": "æ•°æ®åŠ è½½å™¨",
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "position": [
        620,
        720
      ],
      "parameters": {
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "file_id",
                "value": "={{ $json.id }}"
              },
              {
                "name": "pubkey",
                "value": "={{ $json.name }}"
              },
              {
                "name": "=overarching_theme",
                "value": "={{ $('æå–å…ƒæ•°æ®').item.json.output.overarching_theme }}"
              },
              {
                "name": "recurring_topics",
                "value": "={{ $('æå–å…ƒæ•°æ®').item.json.output.recurring_topics }}"
              },
              {
                "name": "pain_points",
                "value": "={{ $('æå–å…ƒæ•°æ®').item.json.output.pain_points }}"
              },
              {
                "name": "analytical_insights",
                "value": "={{ $('æå–å…ƒæ•°æ®').item.json.output.analytical_insights }}"
              },
              {
                "name": "conclusion",
                "value": "={{ $('æå–å…ƒæ•°æ®').item.json.output.conclusion }}"
              },
              {
                "name": "keywords",
                "value": "={{ $('æå–å…ƒæ•°æ®').item.json.output.keywords }}"
              }
            ]
          }
        },
        "dataType": "binary",
        "binaryMode": "specificField"
      },
      "typeVersion": 1
    },
    {
      "id": "84986ee2-4d79-49e8-8778-b8a955cf2174",
      "name": "ä»¤ç‰Œåˆ†å‰²å™¨",
      "type": "@n8n/n8n-nodes-langchain.textSplitterTokenSplitter",
      "position": [
        720,
        860
      ],
      "parameters": {
        "chunkSize": 3000
      },
      "typeVersion": 1
    },
    {
      "id": "82aa7016-f3af-4de8-a410-b1c802041213",
      "name": "Qdrantå‘é‡å­˜å‚¨",
      "type": "@n8n/n8n-nodes-langchain.vectorStoreQdrant",
      "onError": "continueRegularOutput",
      "position": [
        540,
        520
      ],
      "parameters": {
        "mode": "insert",
        "options": {},
        "qdrantCollection": {
          "__rl": true,
          "mode": "id",
          "value": "=nostr-damus-user-profiles"
        }
      },
      "credentials": {
        "qdrantApi": {
          "id": "DJQ4hVAVdWZytjr2",
          "name": "QdrantApi account"
        }
      },
      "executeOnce": false,
      "retryOnFail": true,
      "typeVersion": 1
    },
    {
      "id": "07f4d14a-1864-406b-946b-09c776e3038b",
      "name": "å¾ªç¯å¤„ç†é¡¹ç›®",
      "type": "n8n-nodes-base.splitInBatches",
      "onError": "continueRegularOutput",
      "position": [
        180,
        -140
      ],
      "parameters": {
        "options": {}
      },
      "typeVersion": 3
    },
    {
      "id": "b0f9b066-62de-41bc-afce-dcb4d20d100c",
      "name": "ç­‰å¾…",
      "type": "n8n-nodes-base.wait",
      "position": [
        1020,
        840
      ],
      "webhookId": "237d7f8a-aead-479a-b813-f407d1f37fa5",
      "parameters": {},
      "typeVersion": 1.1
    },
    {
      "id": "2a883003-f5ec-409e-97e4-809360ca11ed",
      "name": "ç‚¹å‡»'æµ‹è¯•å·¥ä½œæµ'æ—¶",
      "type": "n8n-nodes-base.manualTrigger",
      "position": [
        -1160,
        -280
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "cfbb6b77-142f-4689-b051-436f40ababe6",
      "name": "Google GeminièŠå¤©æ¨¡å‹",
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "position": [
        1120,
        -20
      ],
      "parameters": {
        "options": {
          "temperature": 0.4
        },
        "modelName": "models/gemini-2.0-flash-exp"
      },
      "credentials": {
        "googlePalmApi": {
          "id": "L9UNQHflYlyF9Ngd",
          "name": "Google Gemini(PaLM) Api account"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "c9c50387-64a3-473f-9ea7-509a301836a3",
      "name": "åˆå¹¶",
      "type": "n8n-nodes-base.merge",
      "position": [
        820,
        200
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "combineBy": "combineAll"
      },
      "typeVersion": 3
    },
    {
      "id": "ea143b9f-9bd8-4f3f-8979-5a0fd2691e9d",
      "name": "æå–å…ƒæ•°æ®",
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "position": [
        1020,
        -180
      ],
      "parameters": {
        "text": "={{ $json.data }}",
        "options": {
          "systemPromptTemplate": "æ‚¨æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ä¿¡æ¯æå–ç®—æ³•ã€‚\nåªä»æ–‡æœ¬ä¸­æå–ç›¸å…³ä¿¡æ¯ã€‚\nå¦‚æœæ‚¨ä¸çŸ¥é“è¦æå–çš„å±æ€§å€¼ï¼Œå¯ä»¥çœç•¥è¯¥å±æ€§çš„å€¼ã€‚"
        },
        "attributes": {
          "attributes": [
            {
              "name": "overarching_theme",
              "description": "æ€»ç»“â€œæ€»ä½“ä¸»é¢˜â€éƒ¨åˆ†è®¨è®ºçš„ä¸»è¦ä¸»é¢˜ã€‚"
            },
            {
              "name": "recurring_topics",
              "description": "åˆ—å‡ºâ€œå…±åŒè¯é¢˜â€éƒ¨åˆ†æåˆ°çš„é‡å¤è¯é¢˜ï¼Œä»¥å­—ç¬¦ä¸²æ•°ç»„å½¢å¼ã€‚"
            },
            {
              "name": "pain_points",
              "description": "æ€»ç»“â€œç—›ç‚¹â€éƒ¨åˆ†æåˆ°çš„ç”¨æˆ·æŒ«æŠ˜æˆ–æŒ‘æˆ˜ï¼Œä»¥å­—ç¬¦ä¸²æ•°ç»„å½¢å¼ã€‚"
            },
            {
              "name": "analytical_insights",
              "description": "ä»â€œåˆ†ææ´å¯Ÿâ€éƒ¨åˆ†æå–å…³é”®åˆ†æè§‚å¯Ÿåˆ—è¡¨ï¼ŒåŒ…æ‹¬è¯­è°ƒæˆ–è¡Œä¸ºçš„å˜åŒ–ã€‚"
            },
            {
              "name": "conclusion",
              "description": "æ€»ç»“å…³äºç”¨æˆ·è¯é¢˜åŠå…¶æ•´ä½“å…³æ³¨ç‚¹çš„ç»“è®ºã€‚"
            },
            {
              "name": "keywords",
              "description": "ç”Ÿæˆ10ä¸ªå…³é”®è¯åˆ—è¡¨ï¼Œæ•æ‰æ–‡æ¡£çš„ç²¾é«“ï¼ˆä¾‹å¦‚ï¼šâ€œaskNostrâ€ã€â€œå»ä¸­å¿ƒåŒ–â€ã€â€œåƒåœ¾é‚®ä»¶è¿‡æ»¤â€ï¼‰ã€‚"
            }
          ]
        }
      },
      "typeVersion": 1
    },
    {
      "id": "2ddd778f-6676-4a4b-b592-536401831bc8",
      "name": "è·å–æ–‡ä»¶å†…å®¹",
      "type": "n8n-nodes-base.extractFromFile",
      "position": [
        820,
        -180
      ],
      "parameters": {
        "options": {},
        "operation": "text"
      },
      "typeVersion": 1
    },
    {
      "id": "cdbb8bbc-967c-4f01-b844-4d31328153df",
      "name": "ä»Google Driveä¸‹è½½æ–‡ä»¶",
      "type": "n8n-nodes-base.googleDrive",
      "position": [
        500,
        -180
      ],
      "parameters": {
        "fileId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $json.id }}"
        },
        "options": {},
        "operation": "download"
      },
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "UhdXGYLTAJbsa0xX",
          "name": "Google Drive account"
        }
      },
      "typeVersion": 3
    },
    {
      "id": "399e196c-76ec-4077-aacc-f669173b0229",
      "name": "åœ¨Google Driveæ–‡ä»¶å¤¹ä¸­æŸ¥æ‰¾æ–‡ä»¶ID",
      "type": "n8n-nodes-base.googleDrive",
      "position": [
        -620,
        -160
      ],
      "parameters": {
        "filter": {
          "driveId": {
            "mode": "list",
            "value": "My Drive"
          },
          "folderId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $json.folder_id }}"
          }
        },
        "options": {},
        "resource": "fileFolder",
        "returnAll": true
      },
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "UhdXGYLTAJbsa0xX",
          "name": "Google Drive account"
        }
      },
      "typeVersion": 3
    },
    {
      "id": "3bc4f005-c6c8-4f73-816a-1573d6dfb62f",
      "name": "text-embeddings-3-large",
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "position": [
        480,
        720
      ],
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "credentials": {
        "openAiApi": {
          "id": "jEMSvKmtYfzAkhe6",
          "name": "OpenAi account"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "5d42b34a-7156-4163-a2c4-a9cb3c984c96",
      "name": "Googleæ–‡ä»¶å¤¹ID",
      "type": "n8n-nodes-base.set",
      "position": [
        -820,
        -160
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "e6f6188f-c895-4c8c-b39a-0ef55b490fd6",
              "name": "folder_id",
              "type": "string",
              "value": "[Your-Google-Folder-ID]"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "7be310c2-d30f-42a2-8f57-33c7b184e429",
      "name": "gpt-4o-mini1",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "position": [
        -400,
        940
      ],
      "parameters": {
        "options": {}
      },
      "credentials": {
        "openAiApi": {
          "id": "jEMSvKmtYfzAkhe6",
          "name": "OpenAi account"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "18aacfd9-3f6e-4fba-9f68-d8cc95bc667b",
      "name": "æ ¹æ®æ–‡ä»¶IDåˆ é™¤Qdrantç‚¹",
      "type": "@n8n/n8n-nodes-langchain.code",
      "position": [
        -500,
        800
      ],
      "parameters": {
        "code": {
          "execute": {
            "code": "const { QdrantVectorStore } = require(\"@langchain/qdrant\");\nconst { OpenAIEmbeddings } = require(\"@langchain/openai\");\n\n// Qdrantè¿æ¥è¯¦æƒ…\nconst url = \"http://localhost:6333/\";\nconst apiKey = \"\";\n\n// OpenAI APIé…ç½®\nconst openAIApiKey = \"[Your-OpenAI-API-Key]\";\n\n// è·å–è¾“å…¥æ•°æ®\nconst items = this.getInputData()[0];\n// console.log(items)\n\nconst collectionName =  items.json.qdrant_collection_name;\n// console.log(collectionName)\n\nasync function deleteDocumentsFromQdrant() {\n  try {\n    // åˆå§‹åŒ–OpenAIåµŒå…¥\n    const embeddings = new OpenAIEmbeddings({\n      model: \"text-embedding-3-large\",\n      openAIApiKey: openAIApiKey\n    });\n\n    // è¿æ¥åˆ°ç°æœ‰çš„Qdranté›†åˆ\n    const vectorStore = await QdrantVectorStore.fromExistingCollection(embeddings, {\n      url: url,\n      apiKey: apiKey,\n      collectionName: collectionName,\n    });\n\n    const fileIds = items.json.appended_id.map(item => item);\n\n    console.log(fileIds)\n\n    // æ ¹æ®fileIdåˆ é™¤ç‚¹\n    const deletionResults = await Promise.all(fileIds.map(async (file_id) => {\n      const filter = {\n        must: [\n          {\n            key: \"metadata.file_id\",\n            match: { value: file_id }\n          }\n        ]\n      };\n\n      try {\n        // è®¿é—®åº•å±‚Qdrantå®¢æˆ·ç«¯æ‰§è¡Œåˆ é™¤\n        await vectorStore.client.delete(collectionName, { filter });\n        return { file_id, status: \"deleted\" };\n      } catch (error) {\n        console.error(`åˆ é™¤æ–‡ä»¶ID ${file_id} çš„æ–‡æ¡£æ—¶å‡ºé”™:`, error);\n        return { file_id, status: \"error\", message: error.message };\n      }\n    }));\n\n    return deletionResults;\n  } catch (error) {\n    console.error(\"åˆ é™¤è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯:\", error);\n    return error.message;\n  }\n}\n\n// æ‰§è¡Œåˆ é™¤è¿‡ç¨‹\ntry {\n  const result = await deleteDocumentsFromQdrant();\n  console.log(\"åˆ é™¤è¿‡ç¨‹å®Œæˆ:\", result);\n  return [];\n} catch (error) {\n  console.error(\"æ‰§è¡Œåˆ é™¤è¿‡ç¨‹å¤±è´¥:\", error);\n  return [{ json: { error } }];\n}\n\n"
          }
        },
        "inputs": {
          "input": [
            {
              "type": "main",
              "required": true,
              "maxConnections": 1
            },
            {
              "type": "ai_languageModel",
              "required": true,
              "maxConnections": 1
            }
          ]
        },
        "outputs": {
          "output": [
            {
              "type": "main"
            }
          ]
        }
      },
      "typeVersion": 1
    },
    {
      "id": "329cec97-aac1-4714-97ce-add5915b1078",
      "name": "Qdranté›†åˆåç§°",
      "type": "n8n-nodes-base.set",
      "position": [
        -700,
        100
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "11fa71e9-6cbc-4183-9439-e3379b2b970e",
              "name": "qdrant_collection_name",
              "type": "string",
              "value": "nostr-damus-user-profiles"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "82e98da8-530d-4a3c-97e6-5e91ad644a46",
      "name": "æ–‡ä»¶IDåˆ—è¡¨",
      "type": "n8n-nodes-base.summarize",
      "position": [
        -700,
        280
      ],
      "parameters": {
        "options": {},
        "fieldsToSummarize": {
          "values": [
            {
              "field": "id",
              "aggregation": "append"
            }
          ]
        }
      },
      "typeVersion": 1.1
    },
    {
      "id": "f3def614-2709-4847-831d-d6a80c86ec1c",
      "name": "åˆå¹¶1",
      "type": "n8n-nodes-base.merge",
      "position": [
        -340,
        340
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "combineBy": "combineByPosition"
      },
      "typeVersion": 3
    },
    {
      "id": "cfe399fb-8560-4ac4-98f7-4f539ae6a52c",
      "name": "åˆå¹¶2",
      "type": "n8n-nodes-base.merge",
      "position": [
        -80,
        -140
      ],
      "parameters": {},
      "typeVersion": 3
    },
    {
      "id": "1059da47-2abd-4884-b9c2-6b7d1623e31d",
      "name": "ä¾¿ç­¾",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1280,
        560
      ],
      "parameters": {
        "color": 3,
        "width": 1180,
        "height": 760,
        "content": "## å‡†å¤‡Qdrantå‘é‡å­˜å‚¨"
      },
      "typeVersion": 1
    },
    {
      "id": "2616e08f-070e-45b5-906f-40e832519aa2",
      "name": "ç¡®è®¤Qdrantåˆ é™¤ç‚¹",
      "type": "n8n-nodes-base.telegram",
      "position": [
        -1060,
        760
      ],
      "webhookId": "29aac1ac-9345-4e44-babf-ebcfae701d88",
      "parameters": {
        "chatId": "={{ $env.TELEGRAM_CHAT_ID }}",
        "message": "=è­¦å‘Š - Qdrantå‘é‡å­˜å‚¨é›†åˆ\"{{ $json.qdrant_collection_name }}\"ä¸­çš„{{ $json.appended_id.length }}æ¡è®°å½•å°†è¢«åˆ é™¤ã€‚æ‚¨ç¡®å®šè¦ç»§ç»­å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ’¤é”€ï¼",
        "options": {
          "limitWaitTime": {
            "values": {
              "resumeUnit": "minutes",
              "resumeAmount": 15
            }
          }
        },
        "operation": "sendAndWait",
        "approvalOptions": {
          "values": {
            "approvalType": "double"
          }
        }
      },
      "credentials": {
        "telegramApi": {
          "id": "pAIFhguJlkO3c7aQ",
          "name": "Telegram account"
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "9d167192-e87b-41be-87f2-d7ddf866bb8d",
      "name": "å¦‚æœ",
      "type": "n8n-nodes-base.if",
      "position": [
        -1060,
        1000
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 2,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "20f530d6-fd55-420d-b8a9-70e5303f688e",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              },
              "leftValue": "={{ $json.data.approved }}",
              "rightValue": ""
            }
          ]
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "1178f8cf-ece0-4b11-942d-18dd025da366",
      "name": "ä¾¿ç­¾1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        320,
        420
      ],
      "parameters": {
        "color": 7,
        "width": 920,
        "height": 640,
        "content": "## æ‰§è¡ŒQdrantå‘é‡å­˜å‚¨æ“ä½œ"
      },
      "typeVersion": 1
    },
    {
      "id": "cbf17a08-2f4c-4605-8418-5bf93ade7cf4",
      "name": "å‘é€æ‹’ç»æ¶ˆæ¯",
      "type": "n8n-nodes-base.telegram",
      "position": [
        -740,
        1120
      ],
      "webhookId": "382a3b43-b83f-47b1-a276-67c6b98a441a",
      "parameters": {
        "text": "Qdrantå‘é‡å­˜å‚¨æ›´æ–°è¢«æ‹’ç»",
        "chatId": "={{ $env.TELEGRAM_CHAT_ID }}",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "credentials": {
        "telegramApi": {
          "id": "pAIFhguJlkO3c7aQ",
          "name": "Telegram account"
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "890f478a-e000-418d-8582-4fef946e44d8",
      "name": "ä¾¿ç­¾2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -900,
        -380
      ],
      "parameters": {
        "width": 480,
        "height": 840,
        "content": "## ğŸŒŸå·¥ä½œæµé…ç½®\n\n- Google Driveæ–‡ä»¶å¤¹ID\n- Qdranté›†åˆåç§°\n- Google Driveæ–‡ä»¶IDåˆ—è¡¨"
      },
      "typeVersion": 1
    },
    {
      "id": "d2bc2fed-c134-4e54-bd9d-69996be966a3",
      "name": "ä¾¿ç­¾3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        740,
        -280
      ],
      "parameters": {
        "color": 6,
        "width": 640,
        "height": 420,
        "content": "## ä¸ºQdrantæ··åˆæœç´¢æå–å…ƒæ•°æ®"
      },
      "typeVersion": 1
    },
    {
      "id": "61f3c21e-bc2a-47bc-8ab1-678b1f425ee3",
      "name": "ä¾¿ç­¾4",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        400,
        -280
      ],
      "parameters": {
        "color": 2,
        "width": 300,
        "height": 320,
        "content": "## Google Drive"
      },
      "typeVersion": 1
    },
    {
      "id": "61e608e4-ac6a-4131-9ca8-c46a5134bff9",
      "name": "ä¾¿ç­¾5",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        80,
        -360
      ],
      "parameters": {
        "color": 5,
        "width": 1360,
        "height": 1480,
        "content": "## âœ¨ å°†æ–‡æ¡£ä¿å­˜åˆ°Qdrantå‘é‡å­˜å‚¨"
      },
      "typeVersion": 1
    },
    {
      "id": "410681cb-e757-42c0-89de-902edbe998e3",
      "name": "ä¾¿ç­¾6",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -580,
        680
      ],
      "parameters": {
        "color": 5,
        "width": 420,
        "height": 400,
        "content": "## ä»Qdrantå‘é‡å­˜å‚¨åˆ é™¤\næ­¤æ“ä½œæ— æ³•æ’¤é”€ï¼ï¼ï¼"
      },
      "typeVersion": 1
    },
    {
      "id": "238469ce-3710-4681-b1b2-200c1b699d5e",
      "name": "ä¾¿ç­¾7",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1200,
        640
      ],
      "parameters": {
        "color": 4,
        "width": 380,
        "height": 520,
        "content": "## äººå·¥å¹²é¢„\nç”¨æˆ·å¿…é¡»éªŒè¯ä»Qdrantå‘é‡å­˜å‚¨åˆ é™¤ç‚¹"
      },
      "typeVersion": 1
    },
    {
      "id": "0b2f6ff4-dd02-4f0e-b2eb-60b1ce736cf5",
      "name": "ä¾¿ç­¾8",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1280,
        -380
      ],
      "parameters": {
        "color": 4,
        "width": 340,
        "height": 460,
        "content": "## ğŸ‘ä»è¿™é‡Œå¼€å§‹ï¼"
      },
      "typeVersion": 1
    },
    {
      "id": "abde545b-1a23-4b3e-8046-335b9d0fa445",
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "disabled": true,
      "position": [
        -1160,
        -100
      ],
      "webhookId": "3a30557f-9264-4bc8-a253-a9356677c791",
      "parameters": {
        "path": "upsert",
        "options": {}
      },
      "typeVersion": 2
    },
    {
      "id": "897d29af-719d-4fe7-93a9-44c693cc6547",
      "name": "AIä»£ç†",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [
        -600,
        -1200
      ],
      "parameters": {
        "text": "={{ $json.chatInput }}",
        "options": {
          "systemMessage": "æ‚¨æ˜¯ä¸€ä¸ªä¸“é—¨ä½¿ç”¨Nostrç”¨æˆ·æ¡£æ¡ˆå›ç­”ç”¨æˆ·é—®é¢˜çš„æ™ºèƒ½åŠ©æ‰‹ã€‚æ‚¨çš„ä¸»è¦ç›®æ ‡æ˜¯åŸºäºå¯ç”¨çš„å·¥å…·å’Œèµ„æºæä¾›ç²¾ç¡®ã€ä¸Šä¸‹æ–‡ç›¸å…³ä¸”ç®€æ´çš„ç­”æ¡ˆã€‚\n\n### å·¥å…·\nä½¿ç”¨\"nostr_damus_user_profiles\"å·¥å…·æ¥ï¼š\n- æ‰§è¡Œè¯­ä¹‰ç›¸ä¼¼æ€§æœç´¢å¹¶æ£€ç´¢ä¸ç”¨æˆ·æŸ¥è¯¢ç›¸å…³çš„Nostrç”¨æˆ·æ¡£æ¡ˆä¿¡æ¯ã€‚\n- åœ¨éœ€è¦é¢å¤–ä¸Šä¸‹æ–‡æˆ–å…·ä½“ä¿¡æ¯æ—¶è®¿é—®Nostrå’Œ/æˆ–Damusç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯ã€‚\n\n### å…³é”®æŒ‡ä»¤\n1. **å“åº”æŒ‡å—**ï¼š\n   - æ¸…æ¥šåœ°è§£é‡Šæ£€ç´¢åˆ°çš„ä¿¡æ¯å¦‚ä½•è§£å†³ç”¨æˆ·çš„æŸ¥è¯¢ï¼ˆå¦‚æœé€‚ç”¨ï¼‰ã€‚\n   - å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç›¸å…³ä¿¡æ¯ï¼Œè¯·å›å¤ï¼š\"æˆ‘æ— æ³•åœ¨å¯ç”¨èµ„æºä¸­æ‰¾åˆ°ç­”æ¡ˆã€‚\"\n\n2. **ç„¦ç‚¹å’Œç›¸å…³æ€§**ï¼š\n   - ç¡®ä¿æ‰€æœ‰å“åº”éƒ½ç›´æ¥ä¸ç”¨æˆ·çš„é—®é¢˜ä¿æŒä¸€è‡´ã€‚\n   - é¿å…åŒ…å«æ— å…³ç»†èŠ‚æˆ–ä»…ä¾èµ–å†…éƒ¨çŸ¥è¯†ã€‚\n"
        },
        "promptType": "define"
      },
      "typeVersion": 1.7
    },
    {
      "id": "316b0d8d-bbc7-4c40-b6d0-d0c762554fca",
      "name": "çª—å£ç¼“å†²è®°å¿†",
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "position": [
        -580,
        -1000
      ],
      "parameters": {
        "contextWindowLength": 40
      },
      "typeVersion": 1.3
    },
    {
      "id": "f1e342a8-d50e-48a8-9d7a-850f8be93cff",
      "name": "å½“æ”¶åˆ°èŠå¤©æ¶ˆæ¯æ—¶",
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "position": [
        -1160,
        -1200
      ],
      "webhookId": "5f1c0c82-0ff9-40c7-9e2e-b1a96ffe24cd",
      "parameters": {
        "options": {}
      },
      "typeVersion": 1.1
    },
    {
      "id": "12902fa9-5bcb-4e8b-ac13-7f4cb6e7e1d0",
      "name": "Google GeminièŠå¤©æ¨¡å‹1",
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "position": [
        -760,
        -1000
      ],
      "parameters": {
        "options": {
          "maxOutputTokens": 8192
        },
        "modelName": "models/gemini-2.0-flash-exp"
      },
      "credentials": {
        "googlePalmApi": {
          "id": "L9UNQHflYlyF9Ngd",
          "name": "Google Gemini(PaLM) Api account"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "1c5818d4-6251-4d14-8b4f-d1f3ddfbed38",
      "name": "text-embeddings-3-large1",
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "position": [
        -320,
        -840
      ],
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "credentials": {
        "openAiApi": {
          "id": "jEMSvKmtYfzAkhe6",
          "name": "OpenAi account"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "80056067-5d2b-4ac7-8e69-e75bd66a1ad4",
      "name": "ä¾¿ç­¾9",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -900,
        -1300
      ],
      "parameters": {
        "color": 5,
        "width": 860,
        "height": 680,
        "content": "## ğŸ¤–ä»Qdrantå‘é‡å­˜å‚¨æ£€ç´¢å†…å®¹"
      },
      "typeVersion": 1
    },
    {
      "id": "b45b18e4-7773-4eec-837b-f43fc0eeb90c",
      "name": "ä¾¿ç­¾10",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1280,
        -1300
      ],
      "parameters": {
        "color": 4,
        "width": 340,
        "height": 320,
        "content": "## ğŸ—£ï¸ ä¸æ‚¨çš„æ–‡æ¡£èŠå¤©"
      },
      "typeVersion": 1
    },
    {
      "id": "8fe891dd-dee6-4abb-bc09-d90e6d7bf3cb",
      "name": "ä¾¿ç­¾11",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1360,
        -480
      ],
      "parameters": {
        "color": 7,
        "width": 2880,
        "height": 1880,
        "content": "# æ­¥éª¤1 - å°†æ–‡æ¡£ä¿å­˜åˆ°Qdrantå‘é‡å­˜å‚¨"
      },
      "typeVersion": 1
    },
    {
      "id": "4a9bf716-3fc3-4ccc-b831-19a1afdb4588",
      "name": "ä¾¿ç­¾12",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1360,
        -1420
      ],
      "parameters": {
        "color": 7,
        "width": 1780,
        "height": 880,
        "content": "# æ­¥éª¤2 - ä¸Qdrantå‘é‡å­˜å‚¨ä¸­çš„æ–‡æ¡£èŠå¤©"
      },
      "typeVersion": 1
    },
    {
      "id": "fccedfde-c5aa-4237-9d1c-feb9ebabf4f3",
      "name": "Google Drive",
      "type": "n8n-nodes-base.googleDrive",
      "disabled": true,
      "position": [
        120,
        -780
      ],
      "parameters": {
        "name": "=NostrèŠå¤©æœºå™¨äºº - å¤´åƒ - {{ $now }}",
        "content": "={{ $json.output }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "options": {},
        "folderId": {
          "__rl": true,
          "mode": "list",
          "value": "root",
          "cachedResultName": "/ (æ ¹æ–‡ä»¶å¤¹)"
        },
        "operation": "createFromText"
      },
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "UhdXGYLTAJbsa0xX",
          "name": "Google Drive account"
        }
      },
      "typeVersion": 3
    },
    {
      "id": "6d6813f6-4f2e-499a-9e5c-fe15624a91ef",
      "name": "å“åº”ç”¨æˆ·",
      "type": "n8n-nodes-base.set",
      "position": [
        120,
        -960
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "cd8f88e1-19c0-4b9e-914d-e2e7ba21d9fa",
              "name": "output",
              "type": "string",
              "value": "={{ $json.output }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "1c73bae9-2bdd-4383-a6f8-3cf43d3c15be",
      "name": "ä¾¿ç­¾13",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        -1300
      ],
      "parameters": {
        "color": 4,
        "width": 340,
        "height": 300,
        "content": "## ä¿å­˜èŠå¤©å†å²"
      },
      "typeVersion": 1
    },
    {
      "id": "db3dcc69-d1d0-48a1-b949-37f2de802b4a",
      "name": "æ›´æ–°èŠå¤©å†å²",
      "type": "n8n-nodes-base.googleDocs",
      "position": [
        120,
        -1200
      ],
      "parameters": {
        "actionsUi": {
          "actionFields": [
            {
              "text": "=\n-------------------------------\n\n{{ $now }}\n\n{{ $('å½“æ”¶åˆ°èŠå¤©æ¶ˆæ¯æ—¶').item.json.chatInput  }}\n\n{{ $json.output }}",
              "action": "insert"
            }
          ]
        },
        "operation": "update",
        "documentURL": "1ej_qLolUFp1h4eZkrb99T3DWQ3JOwXVEMS3VUjWyVf0"
      },
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "YWEHuG28zOt532MQ",
          "name": "Google Docs account"
        }
      },
      "typeVersion": 2
    },
    {
      "id": "2dd28eed-b71b-44fb-bb78-8cb50b0d0c93",
      "name": "Qdrantå‘é‡å­˜å‚¨å·¥å…·",
      "type": "@n8n/n8n-nodes-langchain.vectorStoreQdrant",
      "position": [
        -420,
        -1000
      ],
      "parameters": {
        "mode": "retrieve-as-tool",
        "topK": 20,
        "options": {},
        "toolName": "nostr_damus_user_profiles",
        "toolDescription": "æ£€ç´¢å…³äºNostræˆ–Damusç”¨æˆ·çš„ä¿¡æ¯",
        "qdrantCollection": {
          "__rl": true,
          "mode": "list",
          "value": "nostr-damus-user-profiles",
          "cachedResultName": "nostr-damus-user-profiles"
        }
      },
      "credentials": {
        "qdrantApi": {
          "id": "DJQ4hVAVdWZytjr2",
          "name": "QdrantApi account"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "3b130cf8-ab8e-4001-a3d0-a129194aee98",
      "name": "OpenAIèŠå¤©æ¨¡å‹",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "disabled": true,
      "position": [
        -760,
        -820
      ],
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4o-mini"
        },
        "options": {}
      },
      "credentials": {
        "openAiApi": {
          "id": "jEMSvKmtYfzAkhe6",
          "name": "OpenAi account"
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "ccc64645-ad14-4b6b-a507-0b5fb0ac945f",
      "name": "å‘é€å®Œæˆæ¶ˆæ¯",
      "type": "n8n-nodes-base.telegram",
      "position": [
        500,
        200
      ],
      "webhookId": "382a3b43-b83f-47b1-a276-67c6b98a441a",
      "parameters": {
        "text": "Qdrantå‘é‡å­˜å‚¨æ›´æ–°å®Œæˆ",
        "chatId": "={{ $env.TELEGRAM_CHAT_ID }}",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "credentials": {
        "telegramApi": {
          "id": "pAIFhguJlkO3c7aQ",
          "name": "Telegram account"
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "885fef53-2246-45b1-a122-ab5b82374585",
      "name": "ä¾¿ç­¾14",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2120,
        -480
      ],
      "parameters": {
        "width": 700,
        "height": 1240,
        "content": "# ğŸ¤– AIé©±åŠ¨çš„RAGèŠå¤©æœºå™¨äººä¸Google Driveé›†æˆ\n\næ­¤å·¥ä½œæµåˆ›å»ºäº†ä¸€ä¸ªå¼ºå¤§çš„RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰èŠå¤©æœºå™¨äººï¼Œå¯ä»¥ä½¿ç”¨Qdrantå‘é‡å­˜å‚¨å’ŒGoogleçš„Gemini AIå¤„ç†ã€å­˜å‚¨å’Œä¸Google Driveä¸­çš„æ–‡æ¡£è¿›è¡Œäº¤äº’ã€‚\n\n## å·¥ä½œåŸç†\n\n### æ–‡æ¡£å¤„ç†å’Œå­˜å‚¨ ğŸ“š\n- ä»æŒ‡å®šçš„Google Driveæ–‡ä»¶å¤¹æ£€ç´¢æ–‡æ¡£\n- å¤„ç†æ–‡æ¡£å¹¶å°†å…¶åˆ†å‰²æˆå¯ç®¡ç†çš„å—\n- ä½¿ç”¨AIæå–å…ƒæ•°æ®ä»¥å¢å¼ºæœç´¢èƒ½åŠ›\n- åœ¨Qdrantä¸­å­˜å‚¨æ–‡æ¡£å‘é‡ä»¥å®ç°é«˜æ•ˆæ£€ç´¢\n\n### æ™ºèƒ½èŠå¤©ç•Œé¢ ğŸ’¬\n- æä¾›ç”±Google Geminié©±åŠ¨çš„å¯¹è¯ç•Œé¢\n- ä½¿ç”¨RAGä»å­˜å‚¨çš„æ–‡æ¡£ä¸­æ£€ç´¢ç›¸å…³ä¸Šä¸‹æ–‡\n- åœ¨Google Docsä¸­ç»´æŠ¤èŠå¤©å†å²ä»¥ä¾›å‚è€ƒ\n- æä¾›å‡†ç¡®ã€ä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„å“åº”\n\n### å‘é‡å­˜å‚¨ç®¡ç† ğŸ—„ï¸\n- å…·æœ‰äººå·¥éªŒè¯çš„å®‰å…¨åˆ é™¤æ“ä½œ\n- åŒ…å«é‡è¦æ“ä½œçš„Telegramé€šçŸ¥\n- é€šè¿‡é€‚å½“çš„ç‰ˆæœ¬æ§åˆ¶ç»´æŠ¤æ•°æ®å®Œæ•´æ€§\n- æ”¯æŒæ–‡æ¡£çš„æ‰¹é‡å¤„ç†\n\n## è®¾ç½®æ­¥éª¤\n\n1. é…ç½®APIå‡­æ®ï¼š\n   - è®¾ç½®Google Driveå’ŒDocsè®¿é—®\n   - é…ç½®Gemini AI API\n   - è®¾ç½®Qdrantå‘é‡å­˜å‚¨è¿æ¥\n   - æ·»åŠ Telegramæœºå™¨äººè¿›è¡Œé€šçŸ¥\n\n2. é…ç½®æ–‡æ¡£æºï¼š\n   - è®¾ç½®Google Driveæ–‡ä»¶å¤¹ID\n   - å®šä¹‰Qdranté›†åˆåç§°\n   - è®¾ç½®æ–‡æ¡£å¤„ç†å‚æ•°\n\n3. æµ‹è¯•å’Œéƒ¨ç½²ï¼š\n   - éªŒè¯æ–‡æ¡£å¤„ç†\n   - æµ‹è¯•èŠå¤©åŠŸèƒ½\n   - ç¡®è®¤å‘é‡å­˜å‚¨æ“ä½œ\n   - æ£€æŸ¥é€šçŸ¥ç³»ç»Ÿ\n\n\næ­¤å·¥ä½œæµéå¸¸é€‚åˆéœ€è¦åˆ›å»ºæ™ºèƒ½èŠå¤©æœºå™¨äººçš„ç»„ç»‡ï¼Œè¿™äº›æœºå™¨äººå¯ä»¥è®¿é—®å’Œç†è§£å¤§å‹æ–‡æ¡£å­˜å‚¨åº“ï¼ŒåŒæ—¶é€šè¿‡RAGæŠ€æœ¯ä¿æŒä¸Šä¸‹æ–‡å¹¶æä¾›å‡†ç¡®å“åº”ã€‚\n"
      },
      "typeVersion": 1
    }
  ],
  "active": false,
  "pinData": {},
  "settings": {
    "timezone": "America/Vancouver",
    "callerPolicy": "workflowsFromSameOwner",
    "executionOrder": "v1"
  },
  "versionId": "0c0d90e5-02f9-4169-b477-fd90c52ce44e",
  "connections": {
    "å¦‚æœ": {
      "main": [
        [
          {
            "node": "æ ¹æ®æ–‡ä»¶IDåˆ é™¤Qdrantç‚¹",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "å‘é€æ‹’ç»æ¶ˆæ¯",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç­‰å¾…": {
      "main": [
        [
          {
            "node": "å¾ªç¯å¤„ç†é¡¹ç›®",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "åˆå¹¶": {
      "main": [
        [
          {
            "node": "Qdrantå‘é‡å­˜å‚¨",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "åˆå¹¶1": {
      "main": [
        [
          {
            "node": "ç¡®è®¤Qdrantåˆ é™¤ç‚¹",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "åˆå¹¶2": {
      "main": [
        [
          {
            "node": "å¾ªç¯å¤„ç†é¡¹ç›®",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AIä»£ç†": {
      "main": [
        [
          {
            "node": "æ›´æ–°èŠå¤©å†å²",
            "type": "main",
            "index": 0
          },
          {
            "node": "å“åº”ç”¨æˆ·",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ•°æ®åŠ è½½å™¨": {
      "ai_document": [
        [
          {
            "node": "Qdrantå‘é‡å­˜å‚¨",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "æ–‡ä»¶IDåˆ—è¡¨": {
      "main": [
        [
          {
            "node": "åˆå¹¶1",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "ä»¤ç‰Œåˆ†å‰²å™¨": {
      "ai_textSplitter": [
        [
          {
            "node": "æ•°æ®åŠ è½½å™¨",
            "type": "ai_textSplitter",
            "index": 0
          }
        ]
      ]
    },
    "å¾ªç¯å¤„ç†é¡¹ç›®": {
      "main": [
        [
          {
            "node": "å‘é€å®Œæˆæ¶ˆæ¯",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ä»Google Driveä¸‹è½½æ–‡ä»¶",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Googleæ–‡ä»¶å¤¹ID": {
      "main": [
        [
          {
            "node": "åœ¨Google Driveæ–‡ä»¶å¤¹ä¸­æŸ¥æ‰¾æ–‡ä»¶ID",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æå–å…ƒæ•°æ®": {
      "main": [
        [
          {
            "node": "åˆå¹¶",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è·å–æ–‡ä»¶å†…å®¹": {
      "main": [
        [
          {
            "node": "æå–å…ƒæ•°æ®",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Qdrantå‘é‡å­˜å‚¨": {
      "main": [
        [
          {
            "node": "ç­‰å¾…",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "çª—å£ç¼“å†²è®°å¿†": {
      "ai_memory": [
        [
          {
            "node": "AIä»£ç†",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Qdranté›†åˆåç§°": {
      "main": [
        [
          {
            "node": "åˆå¹¶1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "text-embeddings-3-large": {
      "ai_embedding": [
        [
          {
            "node": "Qdrantå‘é‡å­˜å‚¨",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Google GeminièŠå¤©æ¨¡å‹": {
      "ai_languageModel": [
        [
          {
            "node": "æå–å…ƒæ•°æ®",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "text-embeddings-3-large1": {
      "ai_embedding": [
        [
          {
            "node": "Qdrantå‘é‡å­˜å‚¨å·¥å…·",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Google GeminièŠå¤©æ¨¡å‹1": {
      "ai_languageModel": [
        [
          {
            "node": "AIä»£ç†",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "å½“æ”¶åˆ°èŠå¤©æ¶ˆæ¯æ—¶": {
      "main": [
        [
          {
            "node": "AIä»£ç†",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç¡®è®¤Qdrantåˆ é™¤ç‚¹": {
      "main": [
        [
          {
            "node": "å¦‚æœ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ ¹æ®æ–‡ä»¶IDåˆ é™¤Qdrantç‚¹": {
      "main": [
        [
          {
            "node": "åˆå¹¶2",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "ä»Google Driveä¸‹è½½æ–‡ä»¶": {
      "main": [
        [
          {
            "node": "è·å–æ–‡ä»¶å†…å®¹",
            "type": "main",
            "index": 0
          },
          {
            "node": "åˆå¹¶",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "ç‚¹å‡»'æµ‹è¯•å·¥ä½œæµ'æ—¶": {
      "main": [
        [
          {
            "node": "Googleæ–‡ä»¶å¤¹ID",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "åœ¨Google Driveæ–‡ä»¶å¤¹ä¸­æŸ¥æ‰¾æ–‡ä»¶ID": {
      "main": [
        [
          {
            "node": "æ–‡ä»¶IDåˆ—è¡¨",
            "type": "main",
            "index": 0
          },
          {
            "node": "Qdranté›†åˆåç§°",
            "type": "main",
            "index": 0
          },
          {
            "node": "åˆå¹¶2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Qdrantå‘é‡å­˜å‚¨å·¥å…·": {
      "ai_tool": [
        [
          {
            "node": "AIä»£ç†",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ],
      "ai_vectorStore": [
        []
      ]
    },
    "gpt-4o-mini1": {
      "ai_languageModel": [
        [
          {
            "node": "æ ¹æ®æ–‡ä»¶IDåˆ é™¤Qdrantç‚¹",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "å“åº”ç”¨æˆ·": {
      "main": [
        []
      ]
    },
    "æ›´æ–°èŠå¤©å†å²": {
      "main": [
        []
      ]
    },
    "OpenAIèŠå¤©æ¨¡å‹": {
      "ai_languageModel": [
        []
      ]
    }
  }
}
